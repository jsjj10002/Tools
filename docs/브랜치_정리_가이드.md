# 브랜치 정리 가이드

이 문서는 프로젝트의 브랜치 정리 방법과 정리 대상 브랜치 목록을 제공합니다.

## 정리 대상 브랜치

### 머지 완료된 브랜치 (삭제 가능)

다음 브랜치들은 이미 PR이 머지되어 있어 삭제해도 안전합니다:

#### Cursor 자동 생성 브랜치
- `origin/cursor/check-and-fix-vercel-errors-in-pr-1c12` (PR #10 머지됨)
- `origin/cursor/review-pr-fix-errors-and-merge-e62c` (PR #10 머지됨)
- `origin/cursor/review-pr-fix-errors-and-merge-4b6a` (PR #9 머지됨)
- `origin/cursor/review-and-plan-missing-feature-implementation-417b` (PR #9 머지됨)
- `origin/cursor/review-and-resolve-project-analysis-issues-0ca9` (PR #8 관련)
- `origin/cursor/review-and-resolve-project-analysis-issues-55ba` (PR #8 관련)

#### Feature 브랜치
- `origin/feature/pdfprocess` (PR #5, #6 머지됨)
- `origin/feature/pdftoimg` (PR #3, #4 머지됨)
- `origin/feature/default-setting` (PR #1 머지됨)

## 브랜치 정리 방법

### 1. 로컬 브랜치 정리

```bash
# develop 브랜치로 전환
git checkout develop

# 최신 상태로 업데이트
git pull origin develop

# 머지된 브랜치 확인
git branch --merged develop

# 머지된 브랜치 삭제 (main, develop 제외)
git branch --merged develop | grep -v "develop\|main" | xargs git branch -d

# 강제 삭제가 필요한 경우 (충돌 브랜치)
git branch -D 브랜치명
```

### 2. 원격 브랜치 정리

#### 단일 브랜치 삭제
```bash
# 원격 브랜치 삭제
git push origin --delete 브랜치명

# 예시
git push origin --delete cursor/review-pr-fix-errors-and-merge-e62c
```

#### 일괄 정리 스크립트 (주의: 실행 전 확인 필요)
```bash
#!/bin/bash

# 머지 완료된 브랜치 목록
BRANCHES=(
  "cursor/check-and-fix-vercel-errors-in-pr-1c12"
  "cursor/review-pr-fix-errors-and-merge-e62c"
  "cursor/review-pr-fix-errors-and-merge-4b6a"
  "cursor/review-and-plan-missing-feature-implementation-417b"
  "cursor/review-and-resolve-project-analysis-issues-0ca9"
  "cursor/review-and-resolve-project-analysis-issues-55ba"
  "feature/pdfprocess"
  "feature/pdftoimg"
  "feature/default-setting"
)

# 각 브랜치 삭제
for branch in "${BRANCHES[@]}"; do
  echo "Deleting remote branch: $branch"
  git push origin --delete "$branch" || echo "Failed to delete $branch"
done

# 원격 브랜치 정보 갱신
git fetch --prune
```

### 3. 자동 정리 스크립트

더 안전한 방법으로, 머지된 브랜치만 자동으로 삭제하는 스크립트:

```bash
#!/bin/bash

# develop 브랜치로 전환
git checkout develop
git pull origin develop

# 머지된 원격 브랜치 확인
git fetch --prune
git branch -r --merged develop | grep -v "develop\|main\|HEAD" | \
  sed 's/origin\///' | \
  while read branch; do
    echo "Deleting merged branch: $branch"
    git push origin --delete "$branch" || echo "Failed to delete $branch"
  done
```

## 정리 시 주의사항

### 확인 사항
1. ✅ 브랜치가 머지되었는지 확인
2. ✅ PR이 닫혔는지 확인
3. ✅ 중요한 변경사항이 없는지 확인

### 삭제하지 말아야 할 브랜치
- ❌ 작업 중인 브랜치
- ❌ 리뷰 중인 PR의 브랜치
- ❌ 향후 참고가 필요한 브랜치

### 복구 방법
만약 실수로 브랜치를 삭제했다면:

```bash
# 삭제된 브랜치 복구 (원격에서)
git fetch origin
git checkout -b 브랜치명 origin/브랜치명

# 또는 커밋 해시로 복구
git checkout -b 브랜치명 커밋해시
```

## 정기 정리 스케줄

### 권장 정리 주기
- **매주**: 머지 완료된 브랜치 정리
- **매월**: 오래된 자동 생성 브랜치 정리 (1개월 이상 미사용)
- **릴리즈 전**: 모든 머지된 브랜치 정리

### 정리 체크리스트
- [ ] 머지된 PR 확인
- [ ] 로컬 브랜치 정리
- [ ] 원격 브랜치 정리
- [ ] 브랜치 목록 확인
- [ ] 문서 업데이트 (필요시)

## 현재 브랜치 상태

### 유지해야 할 브랜치
- `main` - 프로덕션 브랜치
- `develop` - 개발 통합 브랜치
- `feature/*` - 작업 중인 기능 브랜치

### 정리 대상 브랜치 (2025-11-03 기준)
위의 "머지 완료된 브랜치" 목록 참고

## GitHub Actions 자동 정리 (선택사항)

GitHub Actions를 사용하여 자동으로 브랜치를 정리할 수 있습니다:

```yaml
name: Cleanup Merged Branches

on:
  schedule:
    - cron: '0 0 * * 0'  # 매주 일요일 자정
  workflow_dispatch:

jobs:
  cleanup:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Delete merged branches
        run: |
          git fetch --prune
          git branch -r --merged develop | \
            grep -v "develop\|main\|HEAD" | \
            sed 's/origin\///' | \
            xargs -I {} git push origin --delete {} || true
```

## 문제 해결

### 브랜치 삭제 실패
```bash
# 권한 문제 확인
git config --get remote.origin.url

# 원격 브랜치 정보 갱신
git fetch --prune

# 브랜치 존재 여부 확인
git branch -r | grep 브랜치명
```

### 충돌 발생
```bash
# 로컬 브랜치 강제 삭제
git branch -D 브랜치명

# 원격 브랜치 삭제
git push origin --delete 브랜치명
```

## 참고 자료

- [브랜치 관리 정책](./브랜치_관리_정책.md)
- [GitHub 브랜치 삭제](https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-branches-in-your-repository/deleting-and-restoring-branches-in-a-pull-request)
